---
title: 0x04 äºŒåˆ†
date: 2019-02-08 18:34:50
categories: ç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—
tags: äºŒåˆ†
mathjax: true
---

### æ•´æ•°åŸŸäºŒåˆ†

äºŒåˆ†æ¨¡æ¿ä¸€å…±æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«é€‚ç”¨äºä¸åŒæƒ…å†µã€‚
ç®—æ³•æ€è·¯ï¼šå‡è®¾ç›®æ ‡å€¼åœ¨é—­åŒºé—´[l, r]ä¸­ï¼Œ æ¯æ¬¡å°†åŒºé—´é•¿åº¦ç¼©å°ä¸€åŠï¼Œå½“l = ræ—¶ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†ç›®æ ‡å€¼ã€‚

<!--more-->

#### ç‰ˆæœ¬1

å½“åŒºé—´[l, r]çš„æ›´æ–°æ“ä½œæ˜¯r = mid; l = mid + 1;æ—¶ï¼Œè®¡ç®—midæ—¶ä¸éœ€è¦åŠ 1ã€‚

C++ ä»£ç æ¨¡æ¿ï¼š

```cpp
int bsearch_1(int l, int r)
{
    while (l < r)
    {
        int mid = l + r >> 1;
        if (check(mid)) r = mid;
        else l = mid + 1;
    }
    return l;
}
```

##### è§£è¯»

æˆ‘ä»¬è¦åœ¨ä¸‹é¢ä¸€ä¸²æ•°ä¸­ç”¨ä¸Šé¢çš„äºŒåˆ†æŸ¥æ‰¾ä»£ç æŸ¥æ‰¾ $11$ 

![](https://upload-images.jianshu.io/upload_images/13783432-5b4713aab47ed409.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼Œ$(l + r)/2 = 4$ï¼ŒæŸ¥åˆ° $8$ ï¼Œæ˜¯å°äº $11$ çš„ï¼Œäºæ˜¯æ›´æ–°ï¼Œ$l = 4 + 1 = 5$

![](https://upload-images.jianshu.io/upload_images/13783432-ab25e68b04d28534.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼Œ$(l + r)/2 = 6$ ï¼ŒæŸ¥åˆ°$12$ ï¼Œæ˜¯å¤§äº$11$çš„ï¼Œäºæ˜¯æ›´æ–°ï¼Œ$r = mid = 6$

![](https://upload-images.jianshu.io/upload_images/13783432-54437dac350fd9fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ç¬¬ä¸‰æ¬¡æŸ¥è¯¢ï¼Œ$(l+r)/2 = 5$ ï¼ŒæŸ¥åˆ°$10$ï¼Œæ˜¯å°äº$11$çš„ï¼Œäºæ˜¯æ›´æ–°ï¼Œ$l = 5+1 = 6$

![](https://upload-images.jianshu.io/upload_images/13783432-4c0da7240524f734.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æœ€ç»ˆå¾—åˆ°ç»“æœä¸º$12$ ã€‚**12æ˜¯æˆ‘ä»¬æŸ¥æ‰¾åˆ°è¿™ä¸€ä¸²æ•°ä¸­ï¼Œå¤§äºç­‰äº11(æŸ¥æ‰¾æ•°)ä¸­æœ€å°å€¼ã€‚**

æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼šä»¥ä¸ŠäºŒåˆ†æ¨¡æ¿ç”¨æ¥è§£ï¼Œ**æœ€å¤§å€¼æœ€å°é—®é¢˜**ã€‚

#### ç‰ˆæœ¬2

å½“åŒºé—´[l, r]çš„æ›´æ–°æ“ä½œæ˜¯r = mid - 1; l = mid;æ—¶ï¼Œè®¡ç®—midæ—¶éœ€è¦åŠ 1ã€‚

C++ ä»£ç æ¨¡æ¿ï¼š

```cpp
int bsearch_2(int l, int r)
{
    while (l < r)
    {
        int mid = l + r + 1 >> 1;
        if (check(mid)) l = mid;
        else r = mid - 1;
    }
    return l;
}
```

##### è§£è¯»

æˆ‘ä»¬è¦åœ¨ä¸‹é¢ä¸€ä¸²æ•°ä¸­ç”¨ä¸Šé¢çš„äºŒåˆ†æŸ¥æ‰¾ä»£ç æŸ¥æ‰¾ $11$ 

![](https://upload-images.jianshu.io/upload_images/13783432-5b4713aab47ed409.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)ç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼Œ$(l + r+1)/2 = 4$ï¼ŒæŸ¥åˆ° $8$ ï¼Œæ˜¯å°äº $11$ çš„ï¼Œäºæ˜¯æ›´æ–°ï¼Œ$l = 4$

![](https://upload-images.jianshu.io/upload_images/13783432-ab25e68b04d28534.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼Œ$(l + r+1)/2 = 6$ï¼ŒæŸ¥åˆ° $12$ ï¼Œæ˜¯å¤§äº $11$ çš„ï¼Œäºæ˜¯æ›´æ–°ï¼Œ$r = 6-1 = 5$

![](https://upload-images.jianshu.io/upload_images/13783432-7f170f15d8554af5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ç¬¬ä¸‰æ¬¡æŸ¥è¯¢ï¼Œ$(l + r+1)/2 = 5$ï¼ŒæŸ¥åˆ° $10$ ï¼Œæ˜¯å°äº $11$ çš„ï¼Œäºæ˜¯æ›´æ–°ï¼Œ$l = 5$

![](https://upload-images.jianshu.io/upload_images/13783432-e4ad12251d23c0df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æœ€ç»ˆå¾—åˆ°ç»“æœä¸º$10$ ã€‚**10æ˜¯æˆ‘ä»¬æŸ¥æ‰¾åˆ°è¿™ä¸€ä¸²æ•°ä¸­ï¼Œå°äºç­‰äº11(æŸ¥æ‰¾æ•°)ä¸­æœ€å¤§å€¼ã€‚**

æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼šä»¥ä¸ŠäºŒåˆ†æ¨¡æ¿ç”¨æ¥è§£ï¼Œ**æœ€å°å€¼æœ€å¤§é—®é¢˜**ã€‚

### äºŒåˆ†ç­”æ¡ˆ

äºŒåˆ†ç­”æ¡ˆä¸äºŒåˆ†æŸ¥æ‰¾ç±»ä¼¼ï¼Œå³å¯¹æœ‰ç€å•è°ƒæ€§çš„ç­”æ¡ˆè¿›è¡ŒäºŒåˆ†ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ç”¨äºæ±‚è§£æ»¡è¶³æŸç§æ¡ä»¶ä¸‹çš„æœ€å¤§ï¼ˆå°ï¼‰å€¼ã€‚ 

![](https://upload-images.jianshu.io/upload_images/13783432-543739728620b2c8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### ç­”æ¡ˆå•è°ƒæ€§

ç­”æ¡ˆçš„å•è°ƒæ€§å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå…¶å•è°ƒæ€§è¯æ˜å¤šç§å¤šæ ·ï¼Œå¦‚ä¸‹ï¼š 

1. ç§»åŠ¨çŸ³å¤´çš„ä¸ªæ•°è¶Šå¤šï¼Œç­”æ¡ˆè¶Šå¤§ï¼ˆNOIP2015è·³çŸ³å¤´ï¼‰ã€‚ 

2. å‰iå¤©çš„æ¡ä»¶ä¸€å®šæ¯”å‰ i + 1 å¤©æ¡ä»¶æ›´å®¹æ˜“ï¼ˆNOIP2012å€Ÿæ•™å®¤ï¼‰ã€‚ 

3. æ»¡è¶³æ›´å°‘åˆ†é…è¦æ±‚æ¯”æ»¡è¶³æ›´å¤šçš„è¦æ±‚æ›´å®¹æ˜“ï¼ˆNOIP2010å…³æŠ¼ç½ªçŠ¯ï¼‰ã€‚ 

4. æ»¡è¶³æ›´å¤§æœ€å¤§å€¼æ¯”æ»¡è¶³æ›´å°æœ€å¤§å€¼çš„è¦æ±‚æ›´å®¹æ˜“ï¼ˆNOIP2015è¿è¾“è®¡åˆ’ï¼‰ã€‚ 

5. æ—¶é—´è¶Šé•¿ï¼Œè¶Šå®¹æ˜“æ»¡è¶³æ¡ä»¶ï¼ˆNOIP2012ç–«æƒ…æ§åˆ¶ï¼‰ã€‚ 

#### å¯ä»¥è§£å†³çš„é—®é¢˜

**æŠŠæ±‚æœ€ä¼˜è§£çš„é—®é¢˜ï¼Œè½¬åŒ–ä¸ºç»™å®šä¸€ä¸ªå€¼ $mid$ ï¼Œåˆ¤å®šæ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ–¹æ¡ˆï¼Œè¾¾åˆ° $mid$ çš„çš„é—®é¢˜ã€‚**(äºŒåˆ†ç­”æ¡ˆè½¬åŒ–ä¸ºåˆ¤å®š)ã€‚

1. æ±‚æœ€å¤§çš„æœ€å°å€¼ï¼ˆNOIP2015è·³çŸ³å¤´ï¼‰ã€‚ 
2. æ±‚æœ€å°çš„æœ€å¤§å€¼ï¼ˆNOIP2010å…³æŠ¼ç½ªçŠ¯ï¼‰ã€‚ 
3. æ±‚æ»¡è¶³æ¡ä»¶ä¸‹çš„æœ€å°ï¼ˆå¤§ï¼‰å€¼ã€‚ 
4. æ±‚æœ€é è¿‘ä¸€ä¸ªå€¼çš„å€¼ã€‚ 
5. æ±‚æœ€å°çš„èƒ½æ»¡è¶³æ¡ä»¶çš„ä»£ä»·ã€‚ 

#### ä¸€ä¸ªå°ä¾‹å­

>  æœ‰ $N$ æœ¬ä¹¦æ’æˆä¸€è¡Œï¼Œå·²çŸ¥ç¬¬ $i$ æœ¬ä¹¦çš„åšåº¦æ˜¯ $A_i$ ã€‚
>
>  æŠŠä»–ä»¬åˆ†æˆè¿ç»­çš„ $M$ ç»„ï¼Œ$T$ è¡¨ç¤ºåšåº¦ä¹‹å’Œæœ€å¤§çš„ä¸€ç»„çš„åšåº¦ï¼Œä½¿ $T$ æœ€å°ã€‚

é—®çš„æ˜¯æœ€å¤§å€¼æœ€å°ï¼Œå¾ˆæ˜æ˜¾æ˜¯ä¸€é“äºŒåˆ†é¢˜ï¼Œé¢˜ç›®è®©æ±‚ $T$ å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ¥äºŒåˆ†æŸ¥æ‰¾ $T$ çš„å€¼ï¼Œåœ¨æ•´æ•°æ•°è½´ä¸Šï¼Œè‚¯å®šå­˜åœ¨å€¼ï¼Œä½¿å¾— $T$ æˆç«‹ã€‚å‘¢ä¹ˆå¯¹åº”ç€ä½¿ $T$ æˆç«‹çš„è¿™æ®µæ•°è½´ä¸Šï¼Œè‚¯å®šä¹Ÿå­˜åœ¨ä¸€ä¸ªå€¼ï¼Œä½¿å¾— $T$ æœ€å°ã€‚

å› æ­¤ï¼Œå¯å¾—ï¼Œæœ¬é¢˜çš„åšæ³•å°±æ˜¯ï¼Œåœ¨æ•´æ•°æ•°è½´ä¸ŠäºŒåˆ†æŸ¥æ‰¾ä¸€ä¸ª $T$ å€¼ã€‚

è¿™é“é¢˜ä¹Ÿæ²¡æœ‰æµ‹è¯•æ•°æ®ï¼Œåªæ˜¯ä¹¦ä¸Šçš„ä¸€ä¸ªä¸¾ä¾‹ï¼Œæˆ‘å°±ä¸æ‰“æ‰“ç äº†ã€‚

![](https://upload-images.jianshu.io/upload_images/13783432-fffa4fc52621fd4b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### ä¾‹1 

å†œå¤«çº¦ç¿°çš„å†œåœºç”± $N$ å—ç”°åœ°ç»„æˆï¼Œæ¯å—åœ°é‡Œéƒ½æœ‰ä¸€å®šæ•°é‡çš„ç‰›,å…¶æ•°é‡ä¸ä¼šå°‘äº1å¤´ï¼Œä¹Ÿä¸ä¼šè¶…è¿‡2000å¤´ã€‚

çº¦ç¿°å¸Œæœ›ç”¨å›´æ å°†ä¸€éƒ¨åˆ†è¿ç»­çš„ç”°åœ°å›´èµ·æ¥ï¼Œå¹¶ä½¿å¾—å›´èµ·æ¥çš„åŒºåŸŸå†…æ¯å—åœ°åŒ…å«çš„ç‰›çš„æ•°é‡çš„å¹³å‡å€¼è¾¾åˆ°æœ€å¤§ã€‚

å›´èµ·åŒºåŸŸå†…è‡³å°‘éœ€è¦åŒ…å« $F$ å—åœ°ï¼Œå…¶ä¸­ $F$ ä¼šåœ¨è¾“å…¥ä¸­ç»™å‡ºã€‚

åœ¨ç»™å®šæ¡ä»¶ä¸‹ï¼Œè®¡ç®—å›´èµ·åŒºåŸŸå†…æ¯å—åœ°åŒ…å«çš„ç‰›çš„æ•°é‡çš„å¹³å‡å€¼å¯èƒ½çš„æœ€å¤§å€¼æ˜¯å¤šå°‘ã€‚

#### è¾“å…¥æ ¼å¼

ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $N$ å’Œ $F$ ï¼Œæ•°æ®é—´ç”¨ç©ºæ ¼éš”å¼€ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œç¬¬$i+1$è¡Œè¾“å‡ºçš„æ•´æ•°ä»£è¡¨ï¼Œç¬¬$i$ç‰‡åŒºåŸŸå†…åŒ…å«çš„ç‰›çš„æ•°ç›®ã€‚

#### è¾“å‡ºæ ¼å¼

è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºå›´èµ·åŒºåŸŸå†…æ¯å—åœ°åŒ…å«çš„ç‰›çš„æ•°é‡çš„å¹³å‡å€¼å¯èƒ½çš„æœ€å¤§å€¼ä¹˜ä»¥1000å¾—åˆ°çš„æ•°å€¼ã€‚

#### æ•°æ®èŒƒå›´

$1â‰¤Nâ‰¤100000$
$1â‰¤Fâ‰¤N$

#### è¾“å…¥æ ·ä¾‹ï¼š

```
10 6
6 
4
2
10
3
8
5
9
4
1
```

#### è¾“å‡ºæ ·ä¾‹ï¼š

```
6500
```

#### é¢˜è§£ï¼š

é¢˜æ„ï¼šç»™$N$ä¸ªæ•°ï¼Œæ‰¾ä¸€ä¸ªå¹³å‡å€¼æœ€å¤§çš„ï¼Œä¸”é•¿åº¦å¤§äºç­‰äº$F$çš„å­æ®µã€‚

é¢˜ç›®é—®çš„æ˜¯è®©æˆ‘ä»¬æ‰¾ä¸€ä¸ªæœ€å¤§å€¼ï¼Œè¿™ç§æœ€å¤§ï¼Œæœ€å°çš„é—®é¢˜ï¼Œæ— ç¢äºä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯å•çº¯çš„æšä¸¾ï¼Œå¦ä¸€ç§æ˜¯äºŒåˆ†æŸ¥æ‰¾ï¼Œå½“ç„¶åé¢è¿˜æœ‰ä¸€äº›æ›´é«˜çº§çš„ç®—æ³•ã€‚è¿™é“é¢˜çš„æ•°æ®èŒƒå›´ï¼Œå¾ˆæ˜æ˜¾æ˜¯äºŒåˆ†æŸ¥æ‰¾(å…¶å®$10^5$æšä¸¾ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸æ˜¯æ•´æ•°ï¼Œæ˜¯å¯ä»¥å­˜åœ¨å°æ•°çš„)ã€‚

* äºŒåˆ†æŸ¥æ‰¾å‡ºæ¥ä¸€ä¸ªå¹³å‡å€¼$avg$æ¥åˆ¤å®šï¼Œèƒ½å¦æˆç«‹ä¸€ä¸ªå­æ®µå¤§äºç­‰äº$F$ç»„ä¸”å¤§äºç­‰äºè¿™ä¸ªå¹³å‡å€¼$avg$ã€‚

```cpp
int search()
{
    while(r - l > 1e-5)
    {
        double mid = (l + r) / 2;
        if(find(mid)) l = mid;
        else r = mid;
    }
    
    return (int)(r * 1000); 
}
```

* å¯ä»¥åˆ©ç”¨å‰ç¼€å’Œï¼Œ$sum[i] = sum[i-1] + num[i] - avg$ ï¼Œå¦‚æœè¿™ä¸ªå‰ç¼€å’Œä¸­å­˜åœ¨è¿ç»­é•¿åº¦å¤§äºç­‰äº$F$ä¸”å’Œå¤§äºç­‰äº$0$ï¼Œå°±æˆç«‹äº†ã€‚

```cpp
bool find(double avg)
{
    for(int i = 1;i <= n;++i)
        sum[i] = sum[i-1] + num[i] - avg;
    
    double minn = 0;
    for(int i = f,j = 0;i <= n;++i,++j)
    {
        minn = min(minn,sum[j]);
        if(sum[i] - minn >= 0)
            return true;
    }

    return false;
}
```

* å…³äºè¿™ä¸ªå¼å­æ€ä¹ˆæ¨å‡ºï¼ŒğŸ˜‚ï¼Œæˆ‘è¿˜å°ï¼Œæˆ‘è¡¨è¾¾ä¸æ¸…æ¥šï¼Œå¦‚æœéè¦è¯´è¯´ï¼Œå‘¢ï¼Œå¤§æ¦‚æ˜¯ç»éªŒå‘Šè¯‰æˆ‘è¿™ä¸ªå¼å­è¦è¿™ä¹ˆå†™ã€‚

ä¸Šå…¨éƒ¨ä»£ç ï¼š

```cpp
#include<bits/stdc++.h>
using namespace std;

const int MAX = 100010;
int num[MAX],n,f;
double l,r;
double sum[MAX];

void init()
{
    cin >> n >> f;

    for(int i = 1;i <= n;++i)
    {
        cin >> num[i];
        r = max(r,(double)num[i]);
    }
}

bool find(double avg)
{
    for(int i = 1;i <= n;++i)
        sum[i] = sum[i-1] + num[i] - avg;
    
    double minn = 0;
    for(int i = f,j = 0;i <= n;++i,++j)
    {
        minn = min(minn,sum[j]);
        if(sum[i] - minn >= 0)
            return true;
    }

    return false;
}

int search()
{
    while(r - l > 1e-5)
    {
        double mid = (l + r) / 2;
        if(find(mid)) l = mid;
        else r = mid;
    }
    
    return (int)(r * 1000); 
}

int main(int argc, char const *argv[])
{
    ios::sync_with_stdio(false);

    init();

    cout << search();
    
    return 0;
}
```

### å‚è€ƒèµ„æ–™

1. Cosmos[äºŒåˆ†ç­”æ¡ˆæ¨¡æ¿åŠäºŒåˆ†ç­”æ¡ˆé—®é¢˜è®²è§£](https://www.cnblogs.com/lcosmos/p/9438705.html)
2. yxc[äºŒåˆ†æŸ¥æ‰¾ç®—æ³•æ¨¡æ¿](https://www.acwing.com/blog/content/31/)
3. ã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹ lyd
4. ç§¦æ·®å²¸~ç¯ç«é˜‘çŠ [æœ€ä½³çš„ç‰›æ é¢˜è§£](https://www.acwing.com/solution/acwing/content/833/)